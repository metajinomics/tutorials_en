## add annotation into count

First you have assembly file, some how you got abundance matrix, and you uploaded your assembly into MG-RAST, so you know MG-RAST annotate your sequence for you. Also, you have meta data that expline your samples

```
sample_assembly.fa
sample_abundance_matrix.txt
sample.meta.txt
```

your assembly looks like this
```
>contig1
CGCATTCTGCTCGACAACATGGTGCGCATGCGCGACGATGGACAGACGGACACCAGCGTGCTCGAGCAGGCTTTGCAGATCATCCGCGAGCACTCGTCTGCCTCTGCCGATGCGCCTCGTCTGCTGACCGAAGCGAGCGGCAACGTCAACCTGCGCACCATCGCGGCCATTGGACGAACGGGAGTGGACTTCGTCAGCGTGGGGGCTTTGACGCATTCGGTCACCGCACTGGACATCAGCATGAAGATTAAACTCGGACAACAGTGAGGCATGCGCAACACCACTTGTCCTCTGTCTCTCTTGCAAACAGGCAAATTTTCCGCATCAGCTTCAATTTTCACTGACGCCGTCGTTGATTGCGTTTGCCTAGCTCGGAAGCACTGTACAAACAAGCTGTCGGGCAAA
>contig2
GACGAAGATGTCGATAAGTTGGATGCTGACGTATTTGCGAAGATGCAAGCCGCATACGACAAAGTGAAAGAGAATTCCTCCAAAGTGAAAACAAGATCCAATGCAACGCCTGATGCTGTCATGGCGGGATACCCGAGAGACCTTGAAACAGGTGTAGCTCAGGAAAGATTACAGCGGATGAACGAAGAGCTTCTATCTTATCCGGATGACTTCACTGTATTCAGCAAGTTGGATCGGATCTTGAAGCGTCGTGAAGAGCCATTCAAAGGTAAAGGGAAAGTGGACTGGGCTCACGCTGAACAACTGGCATTCGGTTCCATCCTTCAAGACGGCAAACCGATCCGTATTACGGGCCAAGACGTCCAACGGGGTACTTTCGCGCATCGCCATCTTGTGCTTCATGACGAAAAGACAGGGGAGGAATTTGTTCCGCTCCATCATATTAGCGACTCGAACGCTTCATTTGTCGCATACAACAGTCCATTGACTGAATTTGCCGTTGTCGGTTATGAATTCGGTTATAATCTAGAAAAAGACCAGGCTCTGTCGATTTGGGAAGCCCAATATGGGGATTTTGCAAATATGGCACAAGTAATGTTCGACCAATTCATTTCTTCAAGTCATTCGAAATGGGGACAGCAGTCCGGCATGGTCATACTTCTGCCGCATGCATACGAAGGTCAGGGACCGGAACACTCCAGTGCACGTCTTGAAAGGTATTTGCAATTGAGCGCGGAAAACAACTGGACGGTTGCGAACATTTCAAGCGCAGCGAACTATTTCCACGTCCTGCGCAGACAGGCAATGATGCTCGGAACGGAAGTGGAACGTCCACTCGTAATCGTTTCACCGAAATCACTTCTTCGTCATCCGCTCGTTGGTGCCGAAGTA
>contig3
GGGGCGGAGTGGACGGCGCCACGGATGCCCTGGCACGTGTGACGCTCGAGCGATCCACGACAGCACCCGCGGCAGGCTCTTCTTCTTCTACTTCTTTTCCGGCGATCCACGTGGCAGGGTCCTCTGCCGCCGCCGCCGCCGCTGCTTCGTCGTCTGCGGCGGCAGCAGCGGCCGGTCCAGCCATCGTTCCCGCCCACTTGCTCGCCAGTCCTCAGCCTGCCCCCAACAAATTCAGCCTGGAGTACTATCGCAACTTGGAGGAGGAGAACTGCTTCTGGTGCTTCAAGTTGATTTCGCCCACACGCACCTTTCTTTTCCGCGCCGACAACCCTGGATCAATCGAAGCGCGCGTGGCGGCCTCGGCGGCGAGCTCGCCGGCGGGATCGGTGTGCGGGGAGGAACTGCGCAACC
>contig4
CGTCCCCCACGCGAACGATCGACGGGTCGGGATTGAAGCCCGTCAGAATCGGGTTGATAATCTTGCTCATGCGCTTCCGTCCCCCTTTTCGCCTGGCGCCGCCGCTTCCGCGCCTGTTCCCGCTTCGGACGCCAGGGCGCGCATGCCCGCCTGCAGCGTCCGGATGATGCGGTCCGTGTCGTATACGCAGCCTCTCCAGGTGCCGCCGCTCGCCGCCTGAAGCGCGGCCCACAGCCGGGTGTCGTCCGGCAGGTTCGGGTCTTCCGCCAGGCCGGGATGCGGCGGCCTTGCGGCAAGAATCGCCGCACCGGCCTCCGGCGTCTCCGGCAGCTCTCCGCTGCCGACCATGTCGATGCTGCCTTCCAGGCTGCGCGTGTCGACGCGGATGTCCACCCAGTCGCCGTCCCGCAGCCGGCCGACGGGGCCGCCTGCAAGCGCTTCGGGGCCGATATGGCCGATGCAGGCGCCGGTCGAGACGCCGGAGAACCGTGCGTCGGTGATGAGTGACACCTGCCGGCCGAACGGCAGATACTTCAGTGCCGACGTCAGCTGGTACGTCTCCTCCATGCCGGTGCCTGAGGGCCCGCGCCCGATCAGCGCCAGAACGTCGCCGGCCGCGATGCCGCCGGTCTTGATGGCGCGGATTGCCTCACGCTCGGTCGTAAACACCTTGACCCGGCCGACATGCCGGAACACGCCTGCCTCGTCAACGACCGACGGATCGATCGCCGTCGACTTGATGACGGAGCCTTCCGGCGCGATATTGCCGATCGGGAACGTGACGGTCGGCGTAAGGCCGGCCGCCTTCGC
>contig5
ATGAGCTTATCGACATCGATCCCTTCTGCTTCTCCTTCATAGTTGATGAGAACGCGGTGCCGCAAAGCCGGTTTGGCGACAGTTTTAATATCAGCGATCGATACATGGAAACGTCCTGCCATCAGAGCCCTCGCTTTGGCAAGTCGGATGATCGATTGCAACCCACGTGGACCGCTTCCGTATTGAACATATTTATTCCAATCATCTTCGGCATCCGTTCGATGATGTGTCGCTGATACTAGATCGACCGCATAATCCATCATTTCATCTGCGATGACAACCGATTTCGCCATTTCTTGTGCTAAAATAATTGTCTCCGTATCCATCACTTTTTTGATGGCAACCGTTTGCGGTCCGGTTGTCCTCAGCATGATTTCCTTCAATTCTTCCTTTGCGGGATAAGGAAGATGAATCTTGCATAAAAATCGGTCCATTTGTGCTTCAGGCAGTGGATACGTTCCTTCCATCTCAATCGGATTCTGCGTTGCAAGAACGAAGAATGGCCTTGACATCTTCCGGGTTTCGCCAAGTACAGTAACTGTTTTTTCACCCATCGCTTCAAGTAAAGCACTTTGAGTCTTCGGCGTGGCACGGTTGATCTCATCCGCCAATACCATCTGACTGAATATCGGTCCTTCTTTGAAGACAAAACGTTGAACCCCTTCCGGATTCCGTTCCAAAATGCTCGTTCCTGTAATATCGGCCGGCATGAGATCCGGTGTAAATTGAATACGGGAAAAAGACAGGTCCAAAACTTCGGATATCGTCCGGATCAGCATCGTCTTTCCTAAGCCTGGCAGCCCCTCCAACAAGGCATGCCCATCCGCTAAAATGGAATAGATCGAGAATTCGACTGCTTCGTGTTGTCCTACAATGAATTTCCCGATTTCTTCCCGTACTTCTGCAAGCCGTGTGCTCATTTCTTCAAATTGCTCTGGTGAAAACGACATTTGTACAACTCCCATCCATTAGTCATTCGATTGATGAAAAGTAATCGGAAAGGACCCGCTGTAAATCGGCAGGGAGATTCATTTTATCCGACCCTTTTAAATAAGCGTCTTTATAGCTTCCGACCACTTCTTGATATGGCCGTA
>contig6
CCAAGTATCGTGCCCGCAACCACGACATGTATATCGGCCAGTGGGGCATGGACTACTGGGATCCGAACTCGAACGCGGAAACCTTCACCTCCAACCCGAACAACGCCGACGACGGCACGGTCAAGACGCTGGCCTGGCGCAATGCCTGGGATGTGCCGGAGCTGACCGAGCAAACCAAGGCCGCCCTTCTGGAACGCGATAACGACAAGCGCGCCGAAATGTACCAGAAGCTGCAGCAGGAAGCGCTGGACACCAGCCCCTTCGTGATGCTGTTCCAGCAGATCGAGGTCGCCGGCGTGCGCGGCAACGTCAAGAACTACAAGCTCGGGCCGAACTTCGACTCGAACTTCCTCGCGCCCGTGACCAAGGATTGATCCGGAAAGGATCGCTCCGTTGAGCACGGAAACGCATTTGCCGGCAGGGCGCGCCAGGAGGCGCGCCTATGCCACCGCCGCCTCGATCGCCAGTTTTCTGGTCATTGTGGCCACAACCTATCTCGGCCTTCTGGCCGTCACCTTCTTCATCGGCCGCGTCGTGCCCATCGATCCGGTCCTGGCCATCGTCGGTGACCGCGCGCCAGCGCATGTGGTCGAGCGCACGCGCATCGAGATGGGCCTGAACCTGCCCTACTACCAGCAGTTCTTCCTCTATGTGAAAGGCGTGCTGACAGGCGATTTCGGCACCTCGGTGCTGACCACCAACCCGGTCATGACGGACATCCGCCGCGTCTTCCCGGCCACGATGGAGCTCGCCACCGTCGGCACCATCATCGGCGCCGCCTTCGGCATTCCGCTTGGCGTGCTGGCCGCCGTCCGGCGCGGCAGCTTCGCCGACCAGGTCGTGCGCATCATCGGCCTCATCGGCTATTCGGTCCCGATCTTCTGGCTCGGCCTGCTGGCGCTTCTGGTGTTCTACGCGCGGCTCGGCTGGACCGCCGGCCCCGGCCGCATCGACGTGGTGTTCGAATACACCTTCACGCCGATCACCGGCTTCTATCTGCTCGACGCGATCCTCAATCGCAACTGGGCGGCGTTCCGTGACATCTTCGCCCACATCATCCTGCCGGCGTCGCTGCTGGGATATTTCTCGCTGGCCTATATCAGCCGCATGACGCGCTCCTTCATGCTGAACGAGCTGCAGCAGGAATACATCGTCGCCGCGCGCGCCAAGGGCCTGTCGGAAACGCGCATCATCTGGGGCCACGCGCTGCGTAACGCCGCGGTGCCTTTGGTCACCGTGATTGCGCTTTCCTATGCCGGGCTGCTCGAAGGCTCGGTGCTGACCGAGACCGTCTTCGCCTGGCCGGGCCTTGGCCTTTACATCACCAATTCGCTGCAGAACGCCGACATGAACGCGGTGCTGGGCGGCACCATCGTTATCGGCTCGGTCTTCATCGCCATCAACCTTCTTTCCGACGTGCTCTACCGCATGCTCGACCCGAGGACGCGCGCCAGATGAGCGAACTTGCCCTCTCCCGCCGCGAATGGCTGCTCACCGACAGGCCGCAATCGCGCATGCAGGCCCGGCTCGGCCGCGCCTATGTCACCTGGCGCCGTTTCACCGCCAACAAGCTCGCCGTCATCGGCATGCTCATCATCCTGGCGCTGATCTTCGTCGCCATCTTCGCGCCGCTGCTGGCGCCCTATTCGCCCTATATCGGCGATCTCGCCAAGTCGCGGCTGCTGCCGCCAGATGCCGAGCACTGGCTGGGCACCGACGACCAGGGCCGCGACATCCTCTCGCGGCTCATCTACGGCTCGCGGCTCACGCTCCAGGTCGTCGTGCTGGTCGCGGTCATCGCGGCCCCCATCGGCCTGCTGGTCGGCACGGTGGCCGGCTATGCCGGCGGCTGGGTCGACGCGGTCCTGATGCGCATCACCGACATCTTTCTCGCCTTCCCCAAGCTGGTGCTGGCGCTGGCCTTCGTCGCAGCACTCGGGCCCGGCATCGGCAATGCCATCATCGCGATTGCCATCACCTCCTGGCCGCCCTATGCCCGCATCGCGCGCGCCGAGACGCTTACGGTGCGTAATTCCGACTACATCGCCGCCGTTCGGCTGATGGGCGCCTCCCCCTGGCGCATCGTGCTGCGCCACATCATGCCACTGTGCATCTCCTCCCTCGTCGTGCGCGTCACGCTCGACATGGCGGGCATCATCCTCACCGCCGCCGGCCTCGGCTTCCTCGGCCTCGGCGCGCAGCCGCCGCTGCCCGAATGGGGCGCGATGATCGCGTCGGGCCGCCGCTTCATCCTCGACCAGTGGTGGGTGGCCGCCATGCCGGGCGTCGCCATCCTCATCGTCAGCCTCGGCTTCAACCTGCTGGGCGACGGGCTGCGCGACGCGCTCGACCCGCGGGGCAGCAGCCAATGAGCACGCTTCTCCACGTAGAAGACCTGCGCGTCTCCTTCCCCACCCGCACCGGCCTGGTGCAGGCGGTGCGCGGCGTTTCCTTCTCGCTCGGCAAGGAGCGGCTGGGCATCGTCGGCGAATCCGGCTCCGGCAAGTCGCAGACCGGTCGCGCCATAATGGGGCTGACGGCGGAACATGCCGAGATCACGGCCAGGAGGCTCGACTTCAACGGCATCGACCTCTTGAAAACGTCGGCCGCCCAGCGGCGGGCCCTGCGCGGCAAGCGCATCGCCATGATCCTGCAGGACCCGAAATATTCGCTCAACCCGGTCATGACCATCGGCCGCCAGATTGTCGAGGCGCTGCGCGCCCACGAGCCGGTCGGCAGGTCCGAAGCGCGCCGCCGCGCGCTCAACATGCTGGCCGCCGTGCAGATCCGCGACCCCGAGCGCGTCTTCGATCTCTACCCGCACGAAGTGTCGGGCGGCATGGGCCAGCGCGCCATGATCGCCATGATGCTGGTGGCCGGCCCCGAACTGCTGATCGCCGACGAGCCCACCTCGGCCCTCGACGTCACCGTGCAGCTCGAAGTGCTGGGCATTCTCGACCGGCTGGTGGCCGAGCGCGGCATGGGCCTGATCTTCATCTCGCACGACCTGCGCCTGGTTTCATCCTTCTGCGATCGCGTCATCGTCATGTATGCCGGCCGCATCGTGGAGGAACTGCCAGCCTCGAAGCTCTCGGAAGCCGAGCACCCCTATACGCGCGGCCTCCTCAACTGCATGCCCAAGATCGGCGCCGACCGGCACCCGCTGCCGGTGCTCGACCGCAAACCGGAATGGGCGCTATGACCCCCGCACTTGCAATCGACAGCCTCCGCGTCGTCTTTGACGACTTCATTGCGCTCAAAAATGTCAGCCTTTCGGTCGCCCCGGGCGAATCCTTCGGCCTGGTGGGCGAATCCGGTTCCGGCAAGTCCACCCTGCTGCGCGCGGTGGCCGGCCTTGCGCCCGTCACCGGCGGCACCATCGACGTGAGCGGCAAGCCGCTGGGCAAGACCCGCGACAAGGCCTTCTATCGCCAGGTGCAGATGGTATTCCAAGACCCCTACGGTTCGCTGCACCCGCGCCAGACGGTCGACCGGCTGCTGCTCGAACCGCTGGCGATCCACGGCTTCGACAACATCGAAAGGCGCATCCTGCGCGCGCTGAACGAGGTGGGCCTCAGCTCCGCCTTCCGCTTCCGCTATTCGCACCAGCTCTCCGGCGGCCAGCGCCAGCGCGTGGCGATCGCCCGGGCGCTGATCCTCGAGCCGTCCATCCTGCTGCTCGACGAGCCGACCTCGGCGCTCGATGCCTCGGTTCAGGCCGAGGTGCTGAACCTGCTCGAACAGGTGCGCGCCGACCGGAAGCTGACCTTCGTCATGGTCAGCCACGACCTCGCCGTCGTCACCCATATGTGCGACCGGCTGATGGTGATGCAGCACGGCCAGGAGGTGGAGCTGCTGTCCTCGGCCGATCTCGCCGCGCGCAAGGTTGCGCAGGACTACACGCGCAACCTGCTCACCGCCAGCGAGGGTTTTAGGCGTAGCGCGTGATCCTCTTCAAGCGCCCCGGTCCCCTCCCCTCACGGCAGGACTGTCGCGTATGGACGTCGACCCCCACTCCGGTTTGCTTCGCAAACCACCTCTCCCCCGCTCGACGGGGGAGAGGAAACGCCGTCCGTGAGCTTGGCACCCTTCCTCTCCCCTTTTGGGGGAGAGAGGTGCCGAGCGAAGCGAGGCGGAGTGGGGGTTAGCCATGCCTACGCAATTGCCCTCCCCACAGGGGGAGGAAGACGATTTCGTGCCAAGAACGGTGAAGGTGGGTGCCGGGCCATGCAGCAAAGTTCCCCTCCTGTGGGGAGGGGTTAGGGGCGGGGGTACGAGGCGTTGAGCTTATCCCCGCGACCTTTCGCTTGTGGGTTTCACCCACGGGCTTGCGCAACCGCCCATCCGGGATGCTAAAGAAAGGCTGCGCTTTCGGGCTCTGAAGTGAGTCTCGCGCAGTCACACCGCCCTTGCCCGGCAGGCCGGCAATCACAACCAGCAAATTTGTCCGATGCGTCGAGGAGGCGCAATGAAGGTAGGCATTGACATAGGTTCGGGACCCAACGGAACCCCTGCAATGCTCGACCTCGAGGAATTGCTGGCGACCCGCCTGCTCGTCCAGGGCAATTCAGGCTCGGGCAAGTCGCACCTGCTGCGCCGCCTGCTGGAACAGAGCGCGCCCTGGGTGCAGCAATGCATCATCGACCCCGAGGGCGACTTCGTCTCGCTGGCCGACAGGTTCGGCCATGTCGTGGTCGATGCCGCGCGCACCGAAGCCGAGCTCACCCGCATCGCGGCGCGCATCCGCCAGCACCGCGTTTCCGTCGTACTGAACCTAGAAGGCCTCGACGTCGACCAGCAGATGCGCGCCGCCGCCGCTTTCCTCGGCGGCCTGTTCGATGCCGAGCGCGACTATTGGTATCCGGTCTTGGTGGTGGTGGACGAGGCGCAGCTCTTCGCGCCCGCCGCTGCCGGCGAGGTCGCCGACGACGCCCGCCGCCTGTCGCTGGCTGCCATGACCAACCTGATGTGTCGCGGCCGCAAGCGCGGCCTGGCCGGCGTCATCGCCACCCAGCGGCTCGCCAAGCTCGCCAAGAACGTCGCGGCGGAAGCCTCCAACTTCCTGATGGGCCGCACCTTCCTCGACATCGACATGGCGCG

```
And abundance matrix looks like this
```
contig	sample1	sample2	sample3	sample4	sample5	sample6
contig1	1	1	1	2	2	2
contig2	2	2	2	7	7	7
contig3	1	5	9	7	9	9
contig4	1	6	8	6	7	7
contig5	0	9	10	8	9	9
contig6	1	3	4	6	8	8
```

Finally, your meta data looks like this
```
sample	treatment
sample1	0
sample2	0
sample3	0
sample4	1
sample4	1
sample4	1
```

Now, you want to know what is the function of your contig, then add annotation into abundance matrix. So, first you need annotation file. Luckly MG-RAST annotate for you. We want to download it
```
curl -o sample.mgrast_function_SEED.tab -X GET -H "auth:wEnYJf8xMAnNyMvj2sUkZF3kx" "http://api.metagenomics.anl.gov/1/annotation/similarity/mgm4635901.3?type=function&source=SEED"
```

note: you need to replace this (auth:wEnYJf8xMAnNyMvj2sUkZF3kx) into your auth-code. Also, you need to replace mgm4635901.3 into your ID. you can find this on the MG-RAST website.

Then, you have annotation file.
```
query sequence id	hit m5nr id (md5sum)	percentage identity	alignment length,	number of mismatches	number of gap openings query start query end hit start hit end e-value bit score semicolon separated list of annotations
mgm4675652.3|k99_33_1_267_+	48775de94c2d772e3fd2ee0a47f3b5f1	71.43	42	12		38	79	241 282 1.7e-08 57.0 nicotinate-nucleotide pyrophosphorylase (EC:2.4.2.19)
mgm4675652.3|k99_33_1_267_+	da04c4adee3bd96fdcf7832f4975d49f	63.46	52	19			34	85  239	290	1.4e-10			   64.0		     nicotinate-nucleotide pyrophosphorylase (EC:2.4.2.19)
mgm4675652.3|k99_55_1_891_+	e22eb02fe8ae07483daa01a8adbf68d1	72.22	126	35				1   126	350	475			   4.8e-51	     199.0		   2-oxoglutarate dehydrogenase E1 component (EC:1.2.4.2)
mgm4675652.3|k99_84_1_810_-	31ab22982fde149d2f0f125dd471f9f9	74.32	148	38				    4	151	432			   579		     3.9e-59		   226.0	  hypothetical protein
mgm4675652.3|k99_84_1_810_-	de964a17f0160d3701ac605ab9bc2db8	69.33	150	46				    	1	150			   429		     578		   1.5e-56	  217.0	       hypothetical protein;predicted
mgm4675652.3|k99_98_1_1093_-	03007259594dd2d5c330a956a50996c2	69.33	150	46						87			   236		     36			   185		  1.1e-54      211.0	    methanol dehydrogenase regulator
mgm4675652.3|k99_98_1_1093_-	ae8e6cc343669ec333f8b91b239f3fb2	80.20	202	40									   87		     288		   41		  242	       1.9e-90	    330.0    protein MoxR (protein MxaR)
mgm4675652.3|k99_98_1_1093_-	cfe4fd73abdd3b06cb33d195bf7558f6	68.42	114	36									   		     119		   232		  65	       178	    8.5e-38  155.0   putative regulatory protein
mgm4675652.3|k99_261_1_3945_+	d612f551dd7e5de858d93b9dc543541c	86.39	338	45											     1			   141		  477	       22	    359	     1.0e-167	      586.0	 binding-protein-dependent transport systems inner membrane component
mgm4675652.3|k99_261_1_3945_+	756a57fc8c6c515ff1062d7c6550f7db	84.01	319	50											     1			   160		  477	       31	    349	     5.3e-152	      534.0	 ABC transporte;embrane spanning protein (oligopeptide)
mgm4675652.3|k99_261_4513_5095_+					827424c8eb03c3949313de1484b78eb5									     92.75		   193		  14	       		    1	     193	      28	 220 3.0e-97		352.0	 hypothetical protein;hypothetical protein;ATP/GTP-binding motif-containing protein

```

